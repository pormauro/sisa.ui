{
  "info": {
    "_postman_id": "0b0c1de5-4a9b-4a1f-9dd9-plantillas",
    "name": "SISA API",
    "description": "Colección de endpoints protegidos por token Bearer para pagos, plantillas de pago y empresas.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Autenticación",
      "description": "Obtiene el token Bearer requerido para el resto de las operaciones.",
      "item": [
        {
          "name": "Login",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"usuario@example.com\",\n  \"password\": \"<contraseña>\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/login",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "login"
              ]
            },
            "description": "Devuelve el token Bearer utilizado en los módulos autenticados."
          },
          "response": []
        }
      ]
    },
    {
      "name": "Pagos",
      "description": "CRUD completo de pagos operativos protegido por token.",
      "auth": {
        "type": "bearer",
        "bearer": [
          {
            "key": "token",
            "value": "{{authToken}}",
            "type": "string"
          }
        ]
      },
      "item": [
        {
          "name": "Listar pagos",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/payments",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "payments"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Crear pago",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"payment_date\": \"2024-07-01\",\n  \"paid_with_account\": \"CAJA_PPAL\",\n  \"payment_template_id\": 6,\n  \"creditor_type\": \"provider\",\n  \"creditor_provider_id\": 12,\n  \"description\": \"Pago de servicio\",\n  \"category_id\": 3,\n  \"price\": 1500.00,\n  \"charge_client\": false,\n  \"attached_files\": []\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/payments",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "payments"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Actualizar pago",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"payment_date\": \"2024-07-02\",\n  \"paid_with_account\": \"CAJA_PPAL\",\n  \"creditor_type\": \"provider\",\n  \"creditor_provider_id\": 12,\n  \"description\": \"Pago ajustado\",\n  \"category_id\": 3,\n  \"price\": 1520.00,\n  \"charge_client\": false,\n  \"attached_files\": []\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/payments/{{paymentId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "payments",
                "{{paymentId}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Eliminar pago",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/payments/{{paymentId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "payments",
                "{{paymentId}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Generar reporte de comprobantes de pagos",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"start_date\": \"2024-01-01\",\n  \"end_date\": \"2024-01-31\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/payments/report/pdf",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "payments",
                "report",
                "pdf"
              ]
            },
            "description": "Genera el PDF con comprobantes adjuntos marcados como factura real dentro del período indicado. Requiere el permiso generatePaymentReport y responde 404 cuando no existen pagos válidos en el rango."
          },
          "response": []
        },
        {
          "name": "Eliminar reporte de comprobantes de pagos",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "type": "string",
                  "value": "{{token}}"
                }
              ]
            },
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/payments/report/{{file_id}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "payments",
                "report",
                "{{file_id}}"
              ]
            },
            "description": "Elimina un PDF de comprobantes generado y borra su registro en la tabla de archivos. Requiere el permiso deletePaymentReport y autenticación Bearer."
          },
          "response": []
        }
      ]
    },
    {
      "name": "Plantillas de pago",
      "description": "Endpoints para administrar las plantillas reutilizables.",
      "auth": {
        "type": "bearer",
        "bearer": [
          {
            "key": "token",
            "value": "{{authToken}}",
            "type": "string"
          }
        ]
      },
      "item": [
        {
          "name": "Listar plantillas",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/payment_templates",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "payment_templates"
              ]
            },
            "description": "Devuelve la colección de plantillas. El backend utiliza \"title\" como nombre, \"price\" para el importe sugerido y \"client_id\" para el cliente a cargar; la app los normaliza al esquema interno."
          },
          "response": []
        },
        {
          "name": "Crear plantilla",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Combustible 30\",\n  \"icon_name\": \"fuel-pump\",\n  \"payment_date\": \"2025-10-30 08:21:47\",\n  \"paid_with_account\": 5,\n  \"creditor_type\": \"provider\",\n  \"creditor_provider_id\": 12,\n  \"description\": \"30 super\",\n  \"category_id\": 3,\n  \"price\": 20000,\n  \"charge_client\": false,\n  \"attached_files\": [29]\n}"
            },
            "description": "Respuesta esperada: {\n  \"message\": \"Template created\",\n  \"template_id\": 6\n}\nEl backend también puede devolver {\"success\": true, \"payment_template_id\": 123} junto con el header Location, que la app interpreta automáticamente.\nLa UI envía tanto los campos nuevos (\"title\", \"price\", \"payment_date\", \"icon_name\", \"attached_files\") como los alias históricos (\"name\", \"default_amount\", etc.) para mantener compatibilidad con versiones anteriores.",
            "url": {
              "raw": "{{baseUrl}}/payment_templates",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "payment_templates"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Actualizar plantilla",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Combustible 30 (ajustada)\",\n  \"icon_name\": \"fuel-pump\",\n  \"payment_date\": \"2025-11-05 09:00:00\",\n  \"paid_with_account\": 7,\n  \"creditor_type\": \"provider\",\n  \"creditor_provider_id\": 12,\n  \"description\": \"Actualización mensual\",\n  \"category_id\": 3,\n  \"price\": 21500,\n  \"charge_client\": false,\n  \"attached_files\": []\n}"
            },
            "description": "Respuesta esperada: {\n  \"message\": \"Template updated\"\n}\nLa app también considera exitosas las respuestas que solo devuelven `204 No Content` siempre que el servidor responda `response.ok`.\nSi no se incluye el objeto completo, la app toma los valores enviados en el payload y el identificador informado por la API.\nEl frontend serializa también los alias históricos (\"name\", \"default_amount\", etc.) para que APIs previas sigan funcionando sin cambios.",
            "url": {
              "raw": "{{baseUrl}}/payment_templates/{{templateId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "payment_templates",
                "{{templateId}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Eliminar plantilla",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/payment_templates/{{templateId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "payment_templates",
                "{{templateId}}"
              ]
            },
            "description": "El backend puede responder `{\"success\": true}`, `{\"message\": \"Template deleted\"}` o simplemente un `204 No Content`. Cualquier variante con `response.ok` provoca que la app refresque el listado y remueva la plantilla local."
          },
          "response": []
        }
      ]
    },
    {
      "name": "Facturación",
      "description": "Endpoints para gestionar facturas y ítems individuales con token Bearer obligatorio.",
      "item": [
        {
          "name": "Listar facturas",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/invoices",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "invoices"
              ]
            },
            "description": "Devuelve la lista paginada de facturas incluyendo ítems e importes calculados cuando están disponibles."
          },
          "response": []
        },
        {
          "name": "Crear factura con ítems",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"invoice_number\": \"A-0001-00004567\",\n  \"client_id\": 120,\n  \"job_ids\": [\n    45,\n    46\n  ],\n  \"issue_date\": \"2024-05-10\",\n  \"currency\": \"ARS\",\n  \"tax_percentage\": 21,\n  \"tax_amount\": 13020,\n  \"concepts\": [\n    {\n      \"concept_code\": \"SERV-001\",\n      \"description\": \"Guardia técnica\",\n      \"quantity\": 8,\n      \"unit_price\": 5500,\n      \"job_id\": 45\n    },\n    {\n      \"concept_code\": \"SERV-002\",\n      \"description\": \"Mantenimiento preventivo\",\n      \"quantity\": 1,\n      \"unit_price\": 18000,\n      \"job_id\": 46\n    }\n  ],\n  \"metadata\": {\n    \"notes\": \"Generada desde app móvil\"\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/invoices",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "invoices"
              ]
            },
            "description": "Crea una factura en estado borrador enviando los ítems normalizados."
          },
          "response": []
        },
        {
          "name": "Actualizar factura y ítems",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"invoice_number\": \"A-0001-00004567\",\n  \"status\": \"draft\",\n  \"concepts\": [\n    {\n      \"id\": 9,\n      \"concept_code\": \"SERV-001\",\n      \"description\": \"Guardia técnica\",\n      \"quantity\": 6,\n      \"unit_price\": 5500,\n      \"job_id\": 45\n    },\n    {\n      \"concept_code\": \"AJUSTE\",\n      \"description\": \"Ajuste manual\",\n      \"quantity\": 1,\n      \"unit_price\": 2500\n    }\n  ]\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/invoices/{{invoiceId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "invoices",
                "{{invoiceId}}"
              ]
            },
            "description": "Actualiza encabezado y lista completa de ítems de la factura indicada."
          },
          "response": []
        },
        {
          "name": "Agregar ítem a factura",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"concept_code\": \"SERV-003\",\n  \"description\": \"Horas extra\",\n  \"quantity\": 4,\n  \"unit_price\": 4500,\n  \"job_id\": 47\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/invoices/{{invoiceId}}/items",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "invoices",
                "{{invoiceId}}",
                "items"
              ]
            },
            "description": "Agrega un concepto puntual sin reenviar la factura completa."
          },
          "response": []
        },
        {
          "name": "Actualizar concepto de factura",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"description\": \"Horas extra nocturnas\",\n  \"quantity\": 5,\n  \"unit_price\": 4700\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/invoices/{{invoiceId}}/items/{{invoiceItemId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "invoices",
                "{{invoiceId}}",
                "items",
                "{{invoiceItemId}}"
              ]
            },
            "description": "Modifica un concepto existente utilizando el identificador del ítem."
          },
          "response": []
        },
        {
          "name": "Eliminar concepto de factura",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/invoices/{{invoiceId}}/items/{{invoiceItemId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "invoices",
                "{{invoiceId}}",
                "items",
                "{{invoiceItemId}}"
              ]
            },
            "description": "Elimina el concepto indicado dejando registro en el historial de la factura."
          },
          "response": []
        },
        {
          "name": "Emitir factura",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"invoice_number\": \"A-0001-00004567\",\n  \"issue_date\": \"2024-05-12\",\n  \"notes\": \"Confirmada por el cliente\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/invoices/{{invoiceId}}/issue",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "invoices",
                "{{invoiceId}}",
                "issue"
              ]
            },
            "description": "Confirma una factura borrador y la marca como emitida. El cuerpo es opcional; si se envía, permite actualizar campos como `invoice_number` o `issue_date` justo antes de la emisión definitiva."
          },
          "response": []
        },
        {
          "name": "Historial de factura",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/invoices/{{invoiceId}}/history",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "invoices",
                "{{invoiceId}}",
                "history"
              ]
            },
            "description": "Devuelve la lista de eventos (creación, ediciones, emisión, anulaciones, regeneraciones) asociados a una factura específica. Es el endpoint que alimenta el modal de historial en la app."
          },
          "response": []
        },
        {
          "name": "Historial global de facturas",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/invoices/history?event=issued&user_id=1",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "invoices",
                "history"
              ],
              "query": [
                {
                  "key": "event",
                  "value": "issued"
                },
                {
                  "key": "user_id",
                  "value": "1"
                }
              ]
            },
            "description": "Feed global filtrable por tipo de evento (`event`), usuario (`user_id`) o rangos temporales (`from`, `to`). Útil para auditorías masivas y conciliaciones."
          },
          "response": []
        },
        {
          "name": "Regenerar PDF de factura",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/invoices/{{invoiceId}}/regenerate_pdf",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "invoices",
                "{{invoiceId}}",
                "regenerate_pdf"
              ]
            },
            "description": "Solicita al backend que vuelva a generar el PDF asociado a la factura cuando se actualizan metadatos permitidos tras la emisión (por ejemplo, notas internas o datos fiscales secundarios)."
          },
          "response": []
        }
      ]
    },
    {
      "name": "Companies",
      "item": [
        {
          "name": "List Companies",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/companies",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "companies"
              ]
            },
            "description": "**GET {baseUrl}/companies**\n\nDescripción: Endpoint `List Companies` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "Get Companies",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/companies/{{company_id}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "companies",
                "{{company_id}}"
              ]
            },
            "description": "**GET {baseUrl}/companies/{{company_id}}**\n\nDescripción: Endpoint `Get Companies` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "Create Companies",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"razon_social\": \"Empresa Ejemplo SA\",\n  \"id_tipo_doc\": 80,\n  \"nro_doc\": 20111222333,\n  \"id_condicion_iva\": 1,\n  \"nombre_fantasia\": \"Marca Ejemplo\",\n  \"iibb\": \"123-456789-0\",\n  \"inicio_actividad\": \"2021-01-01\",\n  \"profile_file_id\": null,\n  \"activo\": 1,\n  \"timestamp\": \"{{company_timestamp}}\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/companies",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "companies"
              ]
            },
            "description": "**POST {baseUrl}/companies**\n\nDescripción: Endpoint `Create Companies` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const now = new Date();",
                  "const offsetMs = now.getTimezoneOffset() * 60000;",
                  "const local = new Date(now.getTime() - offsetMs);",
                  "const formatted = local.toISOString().slice(0, 19).replace('T', ' ');",
                  "pm.collectionVariables.set('company_timestamp', formatted);"
                ]
              }
            },
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status code is 201', function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "const jsonData = pm.response.json();",
                  "if (jsonData && jsonData.id) {",
                  "    pm.collectionVariables.set('company_id', jsonData.id);",
                  "}",
                  "pm.collectionVariables.set('company_history_expected', 1);"
                ]
              }
            }
          ]
        },
        {
          "name": "Create Companies (duplicate timestamp)",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status code is 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "const jsonData = pm.response.json();",
                  "const expectedId = Number(pm.collectionVariables.get('company_id'));",
                  "pm.test('Duplicate creation reused company id', function () {",
                  "    pm.expect(jsonData).to.have.property('id');",
                  "    pm.expect(Number(jsonData.id)).to.eql(expectedId);",
                  "});",
                  "pm.collectionVariables.set('company_history_expected', 1);"
                ]
              }
            }
          ],
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"razon_social\": \"Empresa Ejemplo SA\",\n  \"id_tipo_doc\": 80,\n  \"nro_doc\": 20111222333,\n  \"id_condicion_iva\": 1,\n  \"nombre_fantasia\": \"Marca Ejemplo\",\n  \"iibb\": \"123-456789-0\",\n  \"inicio_actividad\": \"2021-01-01\",\n  \"profile_file_id\": null,\n  \"activo\": 1,\n  \"timestamp\": \"{{company_timestamp}}\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/companies",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "companies"
              ]
            },
            "description": "**POST {baseUrl}/companies**\n\nDescripción: Endpoint `Create Companies` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "Update Companies",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nombre_fantasia\": \"Marca Renovada\",\n  \"profile_file_id\": 42,\n  \"activo\": 1,\n  \"timestamp\": \"{{company_update_timestamp}}\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/companies/{{company_id}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "companies",
                "{{company_id}}"
              ]
            },
            "description": "**PUT {baseUrl}/companies/{{company_id}}**\n\nDescripción: Endpoint `Update Companies` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const now = new Date();",
                  "const offsetMs = now.getTimezoneOffset() * 60000;",
                  "const local = new Date(now.getTime() - offsetMs);",
                  "const formatted = local.toISOString().slice(0, 19).replace('T', ' ');",
                  "pm.collectionVariables.set('company_update_timestamp', formatted);"
                ]
              }
            },
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status code is 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "const jsonData = pm.response.json();",
                  "pm.test('Update operation succeeded', function () {",
                  "    pm.expect(jsonData).to.have.property('message', 'Company updated');",
                  "});",
                  "pm.collectionVariables.set('company_history_expected', 2);"
                ]
              }
            }
          ]
        },
        {
          "name": "Update Companies (duplicate timestamp)",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status code is 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "const jsonData = pm.response.json();",
                  "pm.test('Duplicate update acknowledged', function () {",
                  "    pm.expect(jsonData).to.have.property('message', 'Company updated');",
                  "});",
                  "pm.collectionVariables.set('company_history_expected', 2);"
                ]
              }
            }
          ],
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nombre_fantasia\": \"Marca Renovada\",\n  \"profile_file_id\": 42,\n  \"activo\": 1,\n  \"timestamp\": \"{{company_update_timestamp}}\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/companies/{{company_id}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "companies",
                "{{company_id}}"
              ]
            },
            "description": "**PUT {baseUrl}/companies/{{company_id}}**\n\nDescripción: Endpoint `Update Companies` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "Delete Companies",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "DELETE",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"timestamp\": \"{{company_delete_timestamp}}\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/companies/{{company_id}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "companies",
                "{{company_id}}"
              ]
            },
            "description": "**DELETE {baseUrl}/companies/{{company_id}}**\n\nDescripción: Endpoint `Delete Companies` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const now = new Date();",
                  "const offsetMs = now.getTimezoneOffset() * 60000;",
                  "const local = new Date(now.getTime() - offsetMs);",
                  "const formatted = local.toISOString().slice(0, 19).replace('T', ' ');",
                  "pm.collectionVariables.set('company_delete_timestamp', formatted);"
                ]
              }
            },
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status code is 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "const jsonData = pm.response.json();",
                  "pm.test('Delete operation succeeded', function () {",
                  "    pm.expect(jsonData).to.have.property('message', 'Company deleted');",
                  "});",
                  "pm.collectionVariables.set('company_history_expected', 3);"
                ]
              }
            }
          ]
        },
        {
          "name": "Delete Companies (duplicate timestamp)",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status code is 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "const jsonData = pm.response.json();",
                  "pm.test('Duplicate deletion acknowledged', function () {",
                  "    pm.expect(jsonData).to.have.property('message', 'Company deleted');",
                  "});",
                  "pm.collectionVariables.set('company_history_expected', 3);"
                ]
              }
            }
          ],
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "DELETE",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"timestamp\": \"{{company_delete_timestamp}}\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/companies/{{company_id}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "companies",
                "{{company_id}}"
              ]
            },
            "description": "**DELETE {baseUrl}/companies/{{company_id}}**\n\nDescripción: Endpoint `Delete Companies` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "Company History",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/companies/{{company_id}}/history",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "companies",
                "{{company_id}}",
                "history"
              ]
            },
            "description": "**GET {baseUrl}/companies/{{company_id}}/history**\n\nDescripción: Endpoint `Company History` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status code is 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "const jsonData = pm.response.json();",
                  "const records = (jsonData && jsonData.data) ? jsonData.data : [];",
                  "const expected = Number(pm.collectionVariables.get('company_history_expected') || 0);",
                  "pm.test('History count matches expectation', function () {",
                  "    pm.expect(records.length).to.eql(expected);",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "List Company Addresses",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/company-addresses",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "company-addresses"
              ]
            },
            "description": "**GET {baseUrl}/company-addresses**\n\nDescripción: Endpoint `List Company Addresses` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "Get Company Addresses",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/company-addresses/1",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "company-addresses",
                "1"
              ]
            },
            "description": "**GET {baseUrl}/company-addresses/1**\n\nDescripción: Endpoint `Get Company Addresses` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "Create Company Addresses",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"empresa_id\": 1,\n  \"etiqueta\": \"Oficina Central\",\n  \"pais\": \"Argentina\",\n  \"provincia\": \"Buenos Aires\",\n  \"ciudad\": \"La Plata\",\n  \"calle\": \"Calle 50\",\n  \"numero\": \"123\",\n  \"es_principal\": 1\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/company-addresses",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "company-addresses"
              ]
            },
            "description": "**POST {baseUrl}/company-addresses**\n\nDescripción: Endpoint `Create Company Addresses` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "Update Company Addresses",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"ciudad\": \"Buenos Aires\",\n  \"es_principal\": 0\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/company-addresses/1",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "company-addresses",
                "1"
              ]
            },
            "description": "**PUT {baseUrl}/company-addresses/1**\n\nDescripción: Endpoint `Update Company Addresses` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "Delete Company Addresses",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "DELETE",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"timestamp\": \"2024-01-01 00:00:00\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/company-addresses/1",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "company-addresses",
                "1"
              ]
            },
            "description": "**DELETE {baseUrl}/company-addresses/1**\n\nDescripción: Endpoint `Delete Company Addresses` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "Company Address History",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/company-addresses/1/history",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "company-addresses",
                "1",
                "history"
              ]
            },
            "description": "**GET {baseUrl}/company-addresses/1/history**\n\nDescripción: Endpoint `Company Address History` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "List Contacts",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/contacts",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "contacts"
              ]
            },
            "description": "**GET {baseUrl}/contacts**\n\nDescripción: Endpoint `List Contacts` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "Get Contacts",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/contacts/1",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "contacts",
                "1"
              ]
            },
            "description": "**GET {baseUrl}/contacts/1**\n\nDescripción: Endpoint `Get Contacts` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "Create Contacts",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nombre\": \"María\",\n  \"apellido\": \"Pérez\",\n  \"cargo\": \"Gerente\",\n  \"notas\": \"Contacto principal\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/contacts",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "contacts"
              ]
            },
            "description": "**POST {baseUrl}/contacts**\n\nDescripción: Endpoint `Create Contacts` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "Update Contacts",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"cargo\": \"Directora Comercial\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/contacts/1",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "contacts",
                "1"
              ]
            },
            "description": "**PUT {baseUrl}/contacts/1**\n\nDescripción: Endpoint `Update Contacts` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "Delete Contacts",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "DELETE",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"timestamp\": \"2024-01-01 00:00:00\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/contacts/1",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "contacts",
                "1"
              ]
            },
            "description": "**DELETE {baseUrl}/contacts/1**\n\nDescripción: Endpoint `Delete Contacts` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "Contact History",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/contacts/1/history",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "contacts",
                "1",
                "history"
              ]
            },
            "description": "**GET {baseUrl}/contacts/1/history**\n\nDescripción: Endpoint `Contact History` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "List Company Contacts",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/company-contacts",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "company-contacts"
              ]
            },
            "description": "**GET {baseUrl}/company-contacts**\n\nDescripción: Endpoint `List Company Contacts` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "Get Company Contacts",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/company-contacts/1",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "company-contacts",
                "1"
              ]
            },
            "description": "**GET {baseUrl}/company-contacts/1**\n\nDescripción: Endpoint `Get Company Contacts` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "Create Company Contacts",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"empresa_id\": 1,\n  \"contacto_id\": 1,\n  \"departamento\": \"Ventas\",\n  \"es_principal\": 1\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/company-contacts",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "company-contacts"
              ]
            },
            "description": "**POST {baseUrl}/company-contacts**\n\nDescripción: Endpoint `Create Company Contacts` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "Update Company Contacts",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"departamento\": \"Soporte\",\n  \"es_principal\": 0\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/company-contacts/1",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "company-contacts",
                "1"
              ]
            },
            "description": "**PUT {baseUrl}/company-contacts/1**\n\nDescripción: Endpoint `Update Company Contacts` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "Delete Company Contacts",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "DELETE",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"timestamp\": \"2024-01-01 00:00:00\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/company-contacts/1",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "company-contacts",
                "1"
              ]
            },
            "description": "**DELETE {baseUrl}/company-contacts/1**\n\nDescripción: Endpoint `Delete Company Contacts` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "Company Contact History",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/company-contacts/1/history",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "company-contacts",
                "1",
                "history"
              ]
            },
            "description": "**GET {baseUrl}/company-contacts/1/history**\n\nDescripción: Endpoint `Company Contact History` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "List Company Channels",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/company-channels",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "company-channels"
              ]
            },
            "description": "**GET {baseUrl}/company-channels**\n\nDescripción: Endpoint `List Company Channels` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "Get Company Channels",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/company-channels/1",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "company-channels",
                "1"
              ]
            },
            "description": "**GET {baseUrl}/company-channels/1**\n\nDescripción: Endpoint `Get Company Channels` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "Create Company Channels",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"empresa_id\": 1,\n  \"tipo\": \"email\",\n  \"valor\": \"contacto@empresa.com\",\n  \"etiqueta\": \"Atención\",\n  \"es_principal\": 1,\n  \"verificado\": 1\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/company-channels",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "company-channels"
              ]
            },
            "description": "**POST {baseUrl}/company-channels**\n\nDescripción: Endpoint `Create Company Channels` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "Update Company Channels",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"valor\": \"ventas@empresa.com\",\n  \"etiqueta\": \"Ventas\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/company-channels/1",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "company-channels",
                "1"
              ]
            },
            "description": "**PUT {baseUrl}/company-channels/1**\n\nDescripción: Endpoint `Update Company Channels` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "Delete Company Channels",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "DELETE",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"timestamp\": \"2024-01-01 00:00:00\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/company-channels/1",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "company-channels",
                "1"
              ]
            },
            "description": "**DELETE {baseUrl}/company-channels/1**\n\nDescripción: Endpoint `Delete Company Channels` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "Company Channel History",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/company-channels/1/history",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "company-channels",
                "1",
                "history"
              ]
            },
            "description": "**GET {baseUrl}/company-channels/1/history**\n\nDescripción: Endpoint `Company Channel History` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "List Contact Channels",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/contact-channels",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "contact-channels"
              ]
            },
            "description": "**GET {baseUrl}/contact-channels**\n\nDescripción: Endpoint `List Contact Channels` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "Get Contact Channels",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/contact-channels/1",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "contact-channels",
                "1"
              ]
            },
            "description": "**GET {baseUrl}/contact-channels/1**\n\nDescripción: Endpoint `Get Contact Channels` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "Create Contact Channels",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"contacto_id\": 1,\n  \"tipo\": \"telefono\",\n  \"valor\": \"+54 11 1234 5678\",\n  \"etiqueta\": \"Celular\",\n  \"es_principal\": 1,\n  \"verificado\": 0\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/contact-channels",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "contact-channels"
              ]
            },
            "description": "**POST {baseUrl}/contact-channels**\n\nDescripción: Endpoint `Create Contact Channels` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "Update Contact Channels",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"valor\": \"+54 11 9999 8888\",\n  \"verificado\": 1\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/contact-channels/1",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "contact-channels",
                "1"
              ]
            },
            "description": "**PUT {baseUrl}/contact-channels/1**\n\nDescripción: Endpoint `Update Contact Channels` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "Delete Contact Channels",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "DELETE",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"timestamp\": \"2024-01-01 00:00:00\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/contact-channels/1",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "contact-channels",
                "1"
              ]
            },
            "description": "**DELETE {baseUrl}/contact-channels/1**\n\nDescripción: Endpoint `Delete Contact Channels` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "Contact Channel History",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/contact-channels/1/history",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "contact-channels",
                "1",
                "history"
              ]
            },
            "description": "**GET {baseUrl}/contact-channels/1/history**\n\nDescripción: Endpoint `Contact Channel History` dentro de Companies.\n\n> Comentario: Requiere enviar el encabezado Authorization con el valor `Bearer {auth_token}`."
          },
          "response": []
        },
        {
          "name": "Search Companies (by name or document)",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/companies/search?q={{search_text}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "companies",
                "search"
              ],
              "query": [
                {
                  "key": "q",
                  "value": "{{search_text}}",
                  "description": "Texto a buscar en razón social o nombre fantasia"
                },
                {
                  "key": "doc",
                  "value": "",
                  "description": "Opcional: número de documento exacto"
                }
              ]
            },
            "description": "**GET {baseUrl}/companies/search**\n\nDescripción: Busca compañías utilizando coincidencias parciales en razón social o nombre de fantasía y opcionalmente por documento.\n\n> Comentario: Requiere token Bearer en Authorization."
          },
          "response": []
        }
      ]
    },
    {
      "name": "Company Memberships",
      "description": "Gestiona el ciclo completo de invitaciones, solicitudes, suspensiones y auditoría de membresías por empresa.",
      "auth": {
        "type": "bearer",
        "bearer": [
          {
            "key": "token",
            "value": "{{authToken}}",
            "type": "string"
          }
        ]
      },
      "item": [
        {
          "name": "List memberships by status",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/companies/{{company_id}}/memberships?status=approved",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "companies",
                "{{company_id}}",
                "memberships"
              ],
              "query": [
                {
                  "key": "status",
                  "value": "approved",
                  "description": "pending, invited, approved, rejected, cancelled, left, removed, suspended o all"
                }
              ]
            },
            "description": "**GET {baseUrl}/companies/{company_id}/memberships**\n\nDevuelve las membresías filtradas por estado, respetando la visibilidad y devolviendo los metadatos disponibles (cargo, departamento, employment_type, fechas, visibilidad y notas internas)."
          },
          "response": []
        },
        {
          "name": "Request membership",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"message\": \"Quisiera sumarme al equipo.\",\n  \"role\": \"member\",\n  \"position_title\": \"Analista Sr\",\n  \"department\": \"Finanzas\",\n  \"started_at\": \"2024-01-15T09:00:00-03:00\",\n  \"employment_type\": \"full_time\",\n  \"visibility\": \"company\",\n  \"profile_excerpt\": \"Experiencia liderando auditorías SOX.\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/companies/{{company_id}}/memberships",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "companies",
                "{{company_id}}",
                "memberships"
              ]
            },
            "description": "**POST {baseUrl}/companies/{company_id}/memberships**\n\nCrea una solicitud en estado pending vinculada al usuario autenticado, registrando mensaje, cargo, departamento y fechas declaradas."
          },
          "response": []
        },
        {
          "name": "Invite member",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"user_id\": {{invited_user_id}},\n  \"role\": \"member\",\n  \"expires_at\": \"2025-01-31T23:59:59\",\n  \"invitation_message\": \"Te esperamos en el equipo\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/companies/{{company_id}}/memberships/invite",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "companies",
                "{{company_id}}",
                "memberships",
                "invite"
              ]
            },
            "description": "**POST {baseUrl}/companies/{company_id}/memberships/invite**\n\nRegistra una invitación en estado invited con token propio, fecha de expiración y notas para el usuario receptor."
          },
          "response": []
        },
        {
          "name": "Accept invitation",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"token\": \"{{membership_token}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/companies/{{company_id}}/memberships/{{membership_id}}/accept",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "companies",
                "{{company_id}}",
                "memberships",
                "{{membership_id}}",
                "accept"
              ]
            },
            "description": "**POST {baseUrl}/companies/{company_id}/memberships/{membership_id}/accept**\n\nValida el token recibido por email o push y deja la membresía en estado approved."
          },
          "response": []
        },
        {
          "name": "Cancel invitation",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"notes\": \"Invitación cancelada por cambios internos\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/companies/{{company_id}}/memberships/{{membership_id}}/cancel-invitation",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "companies",
                "{{company_id}}",
                "memberships",
                "{{membership_id}}",
                "cancel-invitation"
              ]
            },
            "description": "**POST {baseUrl}/companies/{company_id}/memberships/{membership_id}/cancel-invitation**\n\nAnula la invitación antes de que sea aceptada y limpia el token asociado."
          },
          "response": []
        },
        {
          "name": "Approve membership request",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"role\": \"member\",\n  \"notes\": \"Bienvenido al equipo\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/companies/{{company_id}}/memberships/{{membership_id}}/approve",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "companies",
                "{{company_id}}",
                "memberships",
                "{{membership_id}}",
                "approve"
              ]
            },
            "description": "**POST {baseUrl}/companies/{company_id}/memberships/{membership_id}/approve**\n\nAprueba solicitudes pending ajustando el rol final y dejando notas en el historial."
          },
          "response": []
        },
        {
          "name": "Reject membership request",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"reason\": \"La empresa no admite nuevos miembros por ahora.\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/companies/{{company_id}}/memberships/{{membership_id}}/reject",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "companies",
                "{{company_id}}",
                "memberships",
                "{{membership_id}}",
                "reject"
              ]
            },
            "description": "**POST {baseUrl}/companies/{company_id}/memberships/{membership_id}/reject**\n\nRegistra el rechazo con la razón oficial, dejando el registro en estado rejected."
          },
          "response": []
        },
        {
          "name": "Leave company",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"notes\": \"Renuncio voluntariamente a la empresa\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/companies/{{company_id}}/memberships/{{membership_id}}/leave",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "companies",
                "{{company_id}}",
                "memberships",
                "{{membership_id}}",
                "leave"
              ]
            },
            "description": "**POST {baseUrl}/companies/{company_id}/memberships/{membership_id}/leave**\n\nPermite que la persona abandone la empresa registrando notas internas y cambiando el estado a left."
          },
          "response": []
        },
        {
          "name": "Suspend member",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"notes\": \"Suspendido temporalmente por auditoría interna\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/companies/{{company_id}}/memberships/{{membership_id}}/suspend",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "companies",
                "{{company_id}}",
                "memberships",
                "{{membership_id}}",
                "suspend"
              ]
            },
            "description": "**POST {baseUrl}/companies/{company_id}/memberships/{membership_id}/suspend**\n\nCambia el estado a suspended sin perder el historial ni el rol original."
          },
          "response": []
        },
        {
          "name": "Remove member",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"notes\": \"Expulsión por incumplir el acuerdo de confidencialidad\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/companies/{{company_id}}/memberships/{{membership_id}}/remove",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "companies",
                "{{company_id}}",
                "memberships",
                "{{membership_id}}",
                "remove"
              ]
            },
            "description": "**POST {baseUrl}/companies/{company_id}/memberships/{membership_id}/remove**\n\nElimina miembros activos por decisión de la empresa, dejando constancia del motivo interno."
          },
          "response": []
        },
        {
          "name": "Membership history",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/companies/{{company_id}}/memberships/{{membership_id}}/history",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "companies",
                "{{company_id}}",
                "memberships",
                "{{membership_id}}",
                "history"
              ]
            },
            "description": "**GET {baseUrl}/companies/{company_id}/memberships/{membership_id}/history**\n\nDevuelve la cronología completa de aprobaciones, rechazos, invitaciones, suspensiones y notas internas asociadas."
          },
          "response": []
        }
      ]
    },
    {
      "name": "Notifications",
      "item": [
        {
          "name": "Send Test Notification (Superuser Only)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{authToken}}",
                  "type": "string"
                }
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Notificación de prueba\",\n  \"body\": \"Mensaje visible solo para QA\",\n  \"type\": \"manual\",\n  \"severity\": \"info\",\n  \"user_ids\": [\n    2,\n    3\n  ],\n  \"company_id\": 1,\n  \"source_table\": \"invoices\",\n  \"source_id\": 99,\n  \"source_history_id\": 101,\n  \"payload\": {\n    \"cta\": \"/invoices/99\",\n    \"notes\": \"solo superusuario\"\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/notifications/send",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "notifications",
                "send"
              ]
            },
            "description": "**POST {{baseUrl}}/notifications/send**\n\nCrea una notificación manual solo cuando el bearer token pertenece al superusuario (id=1). Requiere enviar al menos un `user_id` o `user_ids` y devuelve los ids que fueron aceptados o descartados."
          },
          "response": [
            {
              "name": "201 Created - enviada",
              "originalRequest": null,
              "status": "Created",
              "code": 201,
              "_postman_previewlanguage": "json",
              "header": [],
              "cookie": [],
              "body": "{\n  \"message\": \"Notificación de prueba enviada\",\n  \"notification_id\": 445,\n  \"recipients\": {\n    \"sent_to\": [\n      2,\n      3\n    ],\n    \"invalid_user_ids\": [\n      99\n    ]\n  }\n}"
            },
            {
              "name": "400 Bad Request - sin usuarios válidos",
              "originalRequest": null,
              "status": "Bad Request",
              "code": 400,
              "_postman_previewlanguage": "json",
              "header": [],
              "cookie": [],
              "body": "{\n  \"error\": \"Ninguno de los usuarios indicados existe en el sistema\",\n  \"invalid_user_ids\": [\n    99\n  ]\n}"
            },
            {
              "name": "403 Forbidden - solo superusuario",
              "originalRequest": null,
              "status": "Forbidden",
              "code": 403,
              "_postman_previewlanguage": "json",
              "header": [],
              "cookie": [],
              "body": "{\n  \"error\": \"Solo el superusuario puede enviar notificaciones de prueba\",\n  \"code\": \"FORBIDDEN\"\n}"
            }
          ]
        },
        {
          "name": "List Notifications",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "type": "string",
                  "value": "{{authToken}}"
                }
              ]
            },
            "description": "**GET {{baseUrl}}/notifications**\n\nRecupera las notificaciones del usuario autenticado. Usa `status` (unread|read|all)\ny filtros opcionales como `company_id`, `limit` y `since` (YYYY-MM-DD HH:MM:SS).",
            "header": [],
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/notifications",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "notifications"
              ]
            }
          },
          "response": [
            {
              "name": "200 OK - listado",
              "originalRequest": null,
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [],
              "cookie": [],
              "body": "{\n  \"notifications\": [\n    {\n      \"id\": 32,\n      \"company_id\": 7,\n      \"type\": \"manual\",\n      \"title\": \"Recordatorio de pago\",\n      \"body\": \"Factura 120 vence mañana\",\n      \"source\": {\n        \"table\": \"invoices\",\n        \"id\": 120,\n        \"history_id\": 980\n      },\n      \"payload\": {\n        \"cta\": \"/invoices/120\"\n      },\n      \"severity\": \"info\",\n      \"created_by_user_id\": 1,\n      \"timestamps\": {\n        \"created_at\": \"2024-12-17 09:45:00\",\n        \"scheduled_at\": null,\n        \"sent_at\": null,\n        \"expires_at\": null\n      },\n      \"state\": {\n        \"is_read\": false,\n        \"read_at\": null,\n        \"is_hidden\": false,\n        \"hidden_at\": null\n      }\n    }\n  ]\n}"
            },
            {
              "name": "400 Bad Request - since inválido",
              "originalRequest": null,
              "status": "Bad Request",
              "code": 400,
              "_postman_previewlanguage": "json",
              "header": [],
              "cookie": [],
              "body": "{\n  \"error\": \"Invalid datetime format for since\"\n}"
            }
          ]
        },
        {
          "name": "List Read Notifications",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "type": "string",
                  "value": "{{authToken}}"
                }
              ]
            },
            "description": "**GET {{baseUrl}}/notifications/read**\n\nDevuelve solo las notificaciones ya leídas del usuario autenticado. Permite filtrar con `company_id`, `limit` y `since` (YYYY-MM-DD HH:MM:SS).",
            "header": [],
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/notifications/read",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "notifications",
                "read"
              ]
            }
          },
          "response": [
            {
              "name": "200 OK - solo leídas",
              "originalRequest": null,
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [],
              "cookie": [],
              "body": "{\n  \"notifications\": [\n    {\n      \"id\": 32,\n      \"company_id\": 7,\n      \"type\": \"manual\",\n      \"title\": \"Recordatorio de pago\",\n      \"body\": \"Factura 120 vence mañana\",\n      \"source\": {\n        \"table\": \"invoices\",\n        \"id\": 120,\n        \"history_id\": 980\n      },\n      \"payload\": {\n        \"cta\": \"/invoices/120\"\n      },\n      \"severity\": \"info\",\n      \"created_by_user_id\": 1,\n      \"timestamps\": {\n        \"created_at\": \"2024-12-17 09:45:00\",\n        \"scheduled_at\": null,\n        \"sent_at\": null,\n        \"expires_at\": null\n      },\n      \"state\": {\n        \"is_read\": true,\n        \"read_at\": \"2024-12-18 08:00:00\",\n        \"is_hidden\": false,\n        \"hidden_at\": null\n      }\n    }\n  ]\n}"
            }
          ]
        },
        {
          "name": "Mark Notification Read",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "type": "string",
                  "value": "{{authToken}}"
                }
              ]
            },
            "description": "**PATCH {{baseUrl}}/notifications/:id/read**\n\nMarca una notificación como leída para el usuario actual. No se permite revertir a no leído.",
            "header": [
              {
                "key": "Content-Type",
                "name": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"read\": true,\n  \"read_at\": \"2025-04-01 10:00:00\"\n}"
            },
            "method": "PATCH",
            "url": {
              "raw": "{{baseUrl}}/notifications/{{id}}/read",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "notifications",
                "{{id}}",
                "read"
              ],
              "variable": [
                {
                  "key": "id",
                  "value": "1"
                }
              ]
            }
          },
          "response": [
            {
              "name": "200 OK - marcada como leída",
              "originalRequest": null,
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [],
              "cookie": [],
              "body": "{\n  \"message\": \"Notification marked as read\",\n  \"notification\": {\n    \"id\": 32,\n    \"company_id\": 7,\n    \"type\": \"manual\",\n    \"title\": \"Recordatorio de pago\",\n    \"body\": \"Factura 120 vence mañana\",\n    \"source\": {\n      \"table\": \"invoices\",\n      \"id\": 120,\n      \"history_id\": 980\n    },\n    \"payload\": {\n      \"cta\": \"/invoices/120\"\n    },\n    \"severity\": \"info\",\n    \"created_by_user_id\": 1,\n    \"timestamps\": {\n      \"created_at\": \"2024-12-17 09:45:00\",\n      \"scheduled_at\": null,\n      \"sent_at\": null,\n      \"expires_at\": null\n    },\n    \"state\": {\n      \"is_read\": true,\n      \"read_at\": \"2024-12-18 08:00:00\",\n      \"is_hidden\": false,\n      \"hidden_at\": null\n    }\n  }\n}"
            },
            {
              "name": "404 Not Found - inexistente",
              "originalRequest": null,
              "status": "Not Found",
              "code": 404,
              "_postman_previewlanguage": "json",
              "header": [],
              "cookie": [],
              "body": "{\n  \"error\": \"Notification not found\"\n}"
            }
          ]
        },
        {
          "name": "Mark All Notifications Read",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "type": "string",
                  "value": "{{authToken}}"
                }
              ]
            },
            "description": "**POST {{baseUrl}}/notifications/mark-all-read**\n\nMarca todas las notificaciones visibles como leídas; acepta `company_id` para limitar el alcance.",
            "header": [
              {
                "key": "Content-Type",
                "name": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"company_id\": 0\n}"
            },
            "method": "POST",
            "url": {
              "raw": "{{baseUrl}}/notifications/mark-all-read",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "notifications",
                "mark-all-read"
              ]
            }
          },
          "response": [
            {
              "name": "200 OK - lote",
              "originalRequest": null,
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [],
              "cookie": [],
              "body": "{\n  \"message\": \"Notifications marked as read\",\n  \"updated_count\": 12\n}"
            },
            {
              "name": "400 Bad Request - company_id inválido",
              "originalRequest": null,
              "status": "Bad Request",
              "code": 400,
              "_postman_previewlanguage": "json",
              "header": [],
              "cookie": [],
              "body": "{\n  \"error\": \"company_id must be numeric\"\n}"
            }
          ]
        },
        {
          "name": "Hide Notification",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "type": "string",
                  "value": "{{authToken}}"
                }
              ]
            },
            "description": "**PATCH {{baseUrl}}/notifications/:id/hide**\n\nOculta la notificación para el usuario autenticado y registra `hidden_at` si se envía.",
            "header": [
              {
                "key": "Content-Type",
                "name": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"hidden_at\": \"2025-04-01 10:00:00\"\n}"
            },
            "method": "PATCH",
            "url": {
              "raw": "{{baseUrl}}/notifications/{{id}}/hide",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "notifications",
                "{{id}}",
                "hide"
              ],
              "variable": [
                {
                  "key": "id",
                  "value": "1"
                }
              ]
            }
          },
          "response": [
            {
              "name": "200 OK - oculta",
              "originalRequest": null,
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [],
              "cookie": [],
              "body": "{\n  \"message\": \"Notification hidden\",\n  \"notification\": {\n    \"id\": 32,\n    \"company_id\": 7,\n    \"type\": \"manual\",\n    \"title\": \"Recordatorio de pago\",\n    \"body\": \"Factura 120 vence mañana\",\n    \"source\": {\n      \"table\": \"invoices\",\n      \"id\": 120,\n      \"history_id\": 980\n    },\n    \"payload\": {\n      \"cta\": \"/invoices/120\"\n    },\n    \"severity\": \"info\",\n    \"created_by_user_id\": 1,\n    \"timestamps\": {\n      \"created_at\": \"2024-12-17 09:45:00\",\n      \"scheduled_at\": null,\n      \"sent_at\": null,\n      \"expires_at\": null\n    },\n    \"state\": {\n      \"is_read\": true,\n      \"read_at\": \"2024-12-18 08:00:00\",\n      \"is_hidden\": true,\n      \"hidden_at\": \"2024-12-18 10:15:00\"\n    }\n  }\n}"
            },
            {
              "name": "404 Not Found - inexistente",
              "originalRequest": null,
              "status": "Not Found",
              "code": 404,
              "_postman_previewlanguage": "json",
              "header": [],
              "cookie": [],
              "body": "{\n  \"error\": \"Notification not found\"\n}"
            }
          ]
        }
      ]
    },
    {
      "name": "Reportes",
      "description": "Controladores y rutas para la tabla reports sin claves foráneas. Todas las operaciones requieren token Bearer salvo autenticación.",
      "auth": {
        "type": "bearer",
        "bearer": [
          {
            "key": "token",
            "value": "{{authToken}}",
            "type": "string"
          }
        ]
      },
      "item": [
        {
          "name": "Listar reportes",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/reports",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "reports"
              ]
            },
            "description": "**GET {{baseUrl}}/reports**\n\nLista reportes almacenados en la tabla de metadatos. Soporta filtros opcionales `report_type`, `status`, `file_id` y `search`. Los estados válidos son `draft`, `generated` y `archived`."
          },
          "response": []
        },
        {
          "name": "Obtener reporte",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/reports/{{reportId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "reports",
                "{{reportId}}"
              ]
            },
            "description": "**GET {{baseUrl}}/reports/{id}**\n\nRecupera un reporte por su identificador y devuelve los metadatos incluyendo `metadata` como JSON cuando corresponde."
          },
          "response": []
        },
        {
          "name": "Historial de reporte",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/reports/{{reportId}}/history",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "reports",
                "{{reportId}}",
                "history"
              ]
            },
            "description": "**GET {{baseUrl}}/reports/{id}/history**\n\nDevuelve la secuencia de operaciones (`CREATION`, `UPDATE`, `DELETION`) con los metadatos almacenados para el reporte indicado."
          },
          "response": []
        },
        {
          "name": "Crear reporte",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"file_id\": 15,\n  \"title\": \"Reporte de finanzas Q2\",\n  \"report_type\": \"finanzas\",\n  \"description\": \"Resumen de ingresos y egresos\",\n  \"status\": \"generated\",\n  \"metadata\": {\"period\": \"2025-Q2\", \"currency\": \"USD\"}\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/reports",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "reports"
              ]
            },
            "description": "**POST {{baseUrl}}/reports**\n\nCrea un nuevo registro de reporte enlazado a un archivo. Campos obligatorios: `file_id`, `title` y `report_type`. Opcionales: `description`, `status` (`draft`, `generated`, `archived`) y `metadata` en formato JSON."
          },
          "response": []
        },
        {
          "name": "Actualizar reporte",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Reporte de finanzas Q2 (actualizado)\",\n  \"status\": \"archived\",\n  \"metadata\": {\"period\": \"2025-Q2\", \"notes\": \"Revisado\"}\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/reports/{{reportId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "reports",
                "{{reportId}}"
              ]
            },
            "description": "**PUT {{baseUrl}}/reports/{id}**\n\nActualiza los campos enviados para el reporte indicado. `metadata` debe ser JSON válido."
          },
          "response": []
        },
        {
          "name": "Eliminar reporte",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/reports/{{reportId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "reports",
                "{{reportId}}"
              ]
            },
            "description": "**DELETE {{baseUrl}}/reports/{id}**\n\nElimina un reporte por su ID únicamente de la tabla de metadatos. El archivo asociado no se elimina de disco ni de la tabla `files`; se conserva el historial en `reports_history`."
          },
          "response": []
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "baseUrl",
      "value": "https://sistema.depros.com.ar"
    },
    {
      "key": "authToken",
      "value": ""
    },
    {
      "key": "paymentId",
      "value": "1"
    },
    {
      "key": "templateId",
      "value": "1"
    },
    {
      "key": "reportId",
      "value": "1"
    },
    {
      "key": "invoiceId",
      "value": "1"
    },
    {
      "key": "invoiceItemId",
      "value": "1"
    },
    {
      "key": "company_id",
      "value": "1"
    },
    {
      "key": "membership_id",
      "value": "1"
    },
    {
      "key": "invited_user_id",
      "value": "15"
    },
    {
      "key": "membership_token",
      "value": ""
    }
  ]
}
